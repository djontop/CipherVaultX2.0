<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CipherVaultX | Secure Encryption</title>
    <meta name="description" content="CipherVaultX - A secure encryption and steganography application for protecting your sensitive files and messages. Features file encryption, text encryption, and image steganography.">
    <meta name="keywords" content="encryption, decryption, steganography, file security, text encryption, image steganography, AI-generated steganography">
    <meta name="author" content="CipherVaultX Team">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <link rel="canonical" href="{{ request.url_root }}">
    <meta property="og:title" content="CipherVaultX | Secure Encryption">
    <meta property="og:description" content="A secure encryption and steganography application for protecting your sensitive files and messages.">
    <meta property="og:image" content="https://r2.fivemanage.com/3nWOCwH1JwmDjPjMMZ9V3/cipherofficiallogo.png">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="CipherVaultX">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CipherVaultX | Secure Encryption">
    <meta name="twitter:description" content="A secure encryption and steganography application for protecting your sensitive files and messages.">
    <meta name="twitter:image" content="https://r2.fivemanage.com/3nWOCwH1JwmDjPjMMZ9V3/cipherofficiallogo.png">
    <meta name="theme-color" content="#4a6cf7">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "CipherVaultX",
      "description": "A secure encryption and steganography application for protecting your sensitive files and messages.",
      "operatingSystem": "Any",
      "applicationCategory": "SecurityApplication",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD",
        "availability": "https://schema.org/InStock"
      },
      "featureList": [
        "File Encryption & Decryption",
        "Text Encryption & Decryption",
        "Image Steganography",
        "AI-Generated Image Steganography"
      ],
      "screenshot": "https://r2.fivemanage.com/3nWOCwH1JwmDjPjMMZ9V3/cipherofficiallogo.png",
      "url": "{{ request.url }}"
    }
    </script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="loading">
    <div class="loader-container" id="loader">
        <i class="fas fa-shield-alt security-icon"></i>
        <i class="fas fa-lock security-icon"></i>
        <i class="fas fa-key security-icon"></i>
        <i class="fas fa-user-secret security-icon"></i>
        
        <h1 class="loader-title">CipherVaultX</h1>
        <img src="https://r2.fivemanage.com/3nWOCwH1JwmDjPjMMZ9V3/cipherofficiallogo.png" 
             alt="CipherVaultX Logo" 
             class="loader-logo"
             id="loader-logo">
        <div class="loader-progress">
            <div class="loader-bar" id="loader-bar"></div>
        </div>
        <div class="loader-text">Initializing secure environment...</div>
        <div class="loader-message" id="loader-message">Setting up encryption protocols</div>
        <div class="loader-complete" id="loader-complete" style="display: none;">
            <i class="fas fa-check-circle"></i> System Ready
        </div>
    </div>

    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="/">
                <img src="{{ url_for('static', filename='images/cipherofficiallogo.png') }}" alt="CipherVaultX Logo" width="32" height="32" class="d-inline-block align-top me-2">
                <span>CipherVaultX</span>
            </a>
            <div class="ms-auto">
                <button id="theme-toggle" class="theme-toggle-btn" aria-label="Toggle Dark Mode">
                    <i class="fas fa-moon dark-icon"></i>
                    <i class="fas fa-sun light-icon"></i>
                </button>
            </div>
        </div>
    </nav>

        <div class="container main-container">
            <div class="row justify-content-center">
                <div class="col-lg-8 col-md-10 col-sm-12">
                    <div class="app-header text-center mb-4 mb-md-5">
                        <h1 class="responsive-heading">Secure File & Text Encryption</h1>
                    </div>
                    
                    <div class="app-card">
                        <ul class="nav nav-pills nav-justified mb-3 mb-md-4" id="mainTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link {% if active_tab != 'decrypt' and active_tab != 'steganography' %}active{% endif %}" id="encrypt-tab" data-bs-toggle="pill" data-bs-target="#encrypt-content" type="button" role="tab">
                                    <i class="fas fa-lock me-2"></i>Encrypt
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link {% if active_tab == 'decrypt' %}active{% endif %}" id="decrypt-tab" data-bs-toggle="pill" data-bs-target="#decrypt-content" type="button" role="tab">
                                    <i class="fas fa-unlock me-2"></i>Decrypt
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link {% if active_tab == 'steganography' %}active{% endif %}" id="steganography-tab" data-bs-toggle="pill" data-bs-target="#steganography-content" type="button" role="tab">
                                    <i class="fas fa-image me-2"></i>Steganography
                                </button>
                            </li>
                        </ul>
                        
                        <div class="tab-content" id="mainTabsContent">
                            <!-- ENCRYPTION TAB -->
                            <div class="tab-pane fade show active" id="encrypt-content" role="tabpanel">
                                <ul class="nav nav-pills nav-justified mb-3 mb-md-4" id="encryptTabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="direct-file-encrypt-tab" data-bs-toggle="pill" 
                                                data-bs-target="#direct-file-encrypt" type="button" role="tab">
                                            <i class="fas fa-file-alt me-2"></i>Direct File
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="direct-text-encrypt-tab" data-bs-toggle="pill" 
                                                data-bs-target="#direct-text-encrypt" type="button" role="tab">
                                            <i class="fas fa-font me-2"></i>Direct Text
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="key-file-encrypt-tab" data-bs-toggle="pill" 
                                                data-bs-target="#key-file-encrypt" type="button" role="tab">
                                            <i class="fas fa-file-alt me-2"></i>File + Key
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="key-text-encrypt-tab" data-bs-toggle="pill" 
                                                data-bs-target="#key-text-encrypt" type="button" role="tab">
                                            <i class="fas fa-font me-2"></i>Text + Key
                                        </button>
                                    </li>
                                </ul>
                                
                                <div class="tab-content" id="encryptTabsContent">
                                    <!-- Direct File Encryption -->
                                    <div class="tab-pane fade show active" id="direct-file-encrypt" role="tabpanel">
                                        <form action="/encrypt_file" method="post" enctype="multipart/form-data">
                                            <input type="hidden" name="use_key" value="false">
                                            <div class="file-upload-container mb-4">
                                                <input type="file" name="file" id="direct-file-upload" class="file-input" required>
                                                <label for="direct-file-upload" class="file-drop-area">
                                                    <div class="file-icon">
                                                        <i class="fas fa-cloud-upload-alt"></i>
                                                    </div>
                                                    <div class="file-message">
                                                        <span class="main-text">Drag & drop file here</span>
                                                        <span class="sub-text">or click to browse files</span>
                                                    </div>
                                                </label>
                                                <div id="direct-file-info" class="file-info"></div>
                                            </div>
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-lock me-2"></i>Encrypt File
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <!-- Direct Text Encryption -->
                                    <div class="tab-pane fade" id="direct-text-encrypt" role="tabpanel">
                                        <form action="/encrypt_text" method="post">
                                            <input type="hidden" name="use_key" value="false">
                                            <div class="form-group mb-4">
                                                <textarea name="text" class="form-control" rows="6" placeholder="Enter text to encrypt..." required></textarea>
                                            </div>
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-lock me-2"></i>Encrypt Text
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <!-- File Encryption with Key -->
                                    <div class="tab-pane fade" id="key-file-encrypt" role="tabpanel">
                                        <form action="/encrypt_file" method="post" enctype="multipart/form-data">
                                            <input type="hidden" name="use_key" value="true">
                                            <div class="form-group mb-4">
                                                <label for="file-encrypt-key" class="form-label">Encryption Key (Optional)</label>
                                                <div class="input-group mb-3">
                                                    <input type="text" name="key" id="file-encrypt-key" class="form-control" placeholder="Enter your key or leave empty to generate a new one">
                                                    <button type="button" class="btn btn-outline-secondary" id="generate-file-key">
                                                        <i class="fas fa-key me-2"></i>Generate
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="file-upload-container mb-4">
                                                <input type="file" name="file" id="key-file-upload" class="file-input" required>
                                                <label for="key-file-upload" class="file-drop-area">
                                                    <div class="file-icon">
                                                        <i class="fas fa-cloud-upload-alt"></i>
                                                    </div>
                                                    <div class="file-message">
                                                        <span class="main-text">Drag & drop file here</span>
                                                        <span class="sub-text">or click to browse files</span>
                                                    </div>
                                                </label>
                                                <div id="key-file-info" class="file-info"></div>
                                            </div>
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-lock me-2"></i>Encrypt File with Key
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <!-- Text Encryption with Key -->
                                    <div class="tab-pane fade" id="key-text-encrypt" role="tabpanel">
                                        <form action="/encrypt_text" method="post">
                                            <input type="hidden" name="use_key" value="true">
                                            <div class="form-group mb-4">
                                                <label for="text-encrypt-key" class="form-label">Encryption Key (Optional)</label>
                                                <div class="input-group mb-3">
                                                    <input type="text" name="key" id="text-encrypt-key" class="form-control" placeholder="Enter your key or leave empty to generate a new one">
                                                    <button type="button" class="btn btn-outline-secondary" id="generate-text-key">
                                                        <i class="fas fa-key me-2"></i>Generate
                                                    </button>
                                                </div>
                                            </div>
                                            <div class="form-group mb-4">
                                                <textarea name="text" class="form-control" rows="6" placeholder="Enter text to encrypt..." required></textarea>
                                            </div>
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-lock me-2"></i>Encrypt Text with Key
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- DECRYPTION TAB -->
                            <div class="tab-pane fade {% if active_tab == 'decrypt' %}show active{% endif %}" id="decrypt-content" role="tabpanel">
                                <ul class="nav nav-pills nav-justified mb-3 mb-md-4" id="decryptTabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="direct-file-decrypt-tab" data-bs-toggle="pill" 
                                                data-bs-target="#direct-file-decrypt" type="button" role="tab">
                                            <i class="fas fa-file-alt me-2"></i>Direct File
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="direct-text-decrypt-tab" data-bs-toggle="pill" 
                                                data-bs-target="#direct-text-decrypt" type="button" role="tab">
                                            <i class="fas fa-font me-2"></i>Direct Text
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="key-file-decrypt-tab" data-bs-toggle="pill" 
                                                data-bs-target="#key-file-decrypt" type="button" role="tab">
                                            <i class="fas fa-file-alt me-2"></i>File + Key
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="key-text-decrypt-tab" data-bs-toggle="pill" 
                                                data-bs-target="#key-text-decrypt" type="button" role="tab">
                                            <i class="fas fa-font me-2"></i>Text + Key
                                        </button>
                                    </li>
                                </ul>
                                
                                <div class="tab-content" id="decryptTabsContent">
                                    <!-- Direct File Decryption -->
                                    <div class="tab-pane fade show active" id="direct-file-decrypt" role="tabpanel">
                                        <form action="/decrypt_file" method="post" enctype="multipart/form-data">
                                            <input type="hidden" name="use_key" value="false">
                                            <div class="file-upload-container mb-4">
                                                <input type="file" name="file" id="direct-file-decrypt-upload" class="file-input" required>
                                                <label for="direct-file-decrypt-upload" class="file-drop-area">
                                                    <div class="file-icon">
                                                        <i class="fas fa-cloud-upload-alt"></i>
                                                    </div>
                                                    <div class="file-message">
                                                        <span class="main-text">Drag & drop encrypted file here</span>
                                                        <span class="sub-text">or click to browse files</span>
                                                    </div>
                                                </label>
                                                <div id="direct-file-decrypt-info" class="file-info"></div>
                                            </div>
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-unlock me-2"></i>Decrypt File
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <!-- Direct Text Decryption -->
                                    <div class="tab-pane fade" id="direct-text-decrypt" role="tabpanel">
                                        <form action="/decrypt_text" method="post">
                                            <input type="hidden" name="use_key" value="false">
                                            <div class="form-group mb-4">
                                                <textarea name="text" class="form-control" rows="6" placeholder="Enter encrypted text to decrypt..." required></textarea>
                                            </div>
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-unlock me-2"></i>Decrypt Text
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <!-- File Decryption with Key -->
                                    <div class="tab-pane fade" id="key-file-decrypt" role="tabpanel">
                                        <form action="/decrypt_file" method="post" enctype="multipart/form-data">
                                            <input type="hidden" name="use_key" value="true">
                                            <div class="form-group mb-4">
                                                <label for="file-decrypt-key" class="form-label">Decryption Key (Required)</label>
                                                <input type="text" name="key" id="file-decrypt-key" class="form-control" placeholder="Enter your encryption key" required>
                                            </div>
                                            <div class="file-upload-container mb-4">
                                                <input type="file" name="file" id="key-file-decrypt-upload" class="file-input" required>
                                                <label for="key-file-decrypt-upload" class="file-drop-area">
                                                    <div class="file-icon">
                                                        <i class="fas fa-cloud-upload-alt"></i>
                                                    </div>
                                                    <div class="file-message">
                                                        <span class="main-text">Drag & drop encrypted file here</span>
                                                        <span class="sub-text">or click to browse files</span>
                                                    </div>
                                                </label>
                                                <div id="key-file-decrypt-info" class="file-info"></div>
                                            </div>
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-unlock me-2"></i>Decrypt File with Key
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <!-- Text Decryption with Key -->
                                    <div class="tab-pane fade" id="key-text-decrypt" role="tabpanel">
                                        <form action="/decrypt_text" method="post">
                                            <input type="hidden" name="use_key" value="true">
                                            <div class="form-group mb-4">
                                                <label for="text-decrypt-key" class="form-label">Decryption Key (Required)</label>
                                                <input type="text" name="key" id="text-decrypt-key" class="form-control" placeholder="Enter your encryption key" required>
                                            </div>
                                            <div class="form-group mb-4">
                                                <textarea name="text" class="form-control" rows="6" placeholder="Enter encrypted text to decrypt..." required></textarea>
                                            </div>
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-unlock me-2"></i>Decrypt Text with Key
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- STEGANOGRAPHY TAB -->
                            <div class="tab-pane fade {% if active_tab == 'steganography' %}show active{% endif %}" id="steganography-content" role="tabpanel">
                                <ul class="nav nav-pills nav-justified mb-3 mb-md-4" id="steganoTabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="hide-message-tab" data-bs-toggle="pill" 
                                                data-bs-target="#hide-message-content" type="button" role="tab">
                                            <i class="fas fa-eye-slash me-2"></i>Hide Message
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="reveal-message-tab" data-bs-toggle="pill" 
                                                data-bs-target="#reveal-message-content" type="button" role="tab">
                                            <i class="fas fa-eye me-2"></i>Reveal Message
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="edit-message-tab" data-bs-toggle="pill" 
                                                data-bs-target="#edit-message-content" type="button" role="tab">
                                            <i class="fas fa-edit me-2"></i>Edit Message
                                        </button>
                                    </li>
                                </ul>
                                
                                <div class="tab-content" id="steganoTabsContent">
                                    <!-- Hide Message in Image -->
                                    <div class="tab-pane fade show active" id="hide-message-content" role="tabpanel">
                                        <form action="{{ url_for('hide_message') }}" method="post" enctype="multipart/form-data" id="hide-message-form">
                                            <div class="form-group mb-4">
                                                <label for="stegano-message" class="form-label">Message to Hide</label>
                                                <textarea name="message" id="stegano-message" class="form-control" rows="4" placeholder="Enter message to hide in image..." required></textarea>
                                            </div>
                                            
                                            <div class="form-check form-switch mb-4">
                                                <input class="form-check-input" type="checkbox" id="use-ai-toggle">
                                                <input type="hidden" name="use_ai" id="use-ai-value" value="false">
                                                <label class="form-check-label" for="use-ai-toggle">Use AI-generated image</label>
                                            </div>
                                            
                                            <div id="upload-image-section" class="mb-4">
                                                <div class="file-upload-container">
                                                    <input type="file" name="image" id="hide-image-upload" class="file-input" accept="image/*" required>
                                                    <label for="hide-image-upload" class="file-drop-area">
                                                        <div class="file-icon">
                                                            <i class="fas fa-cloud-upload-alt"></i>
                                                        </div>
                                                        <div class="file-message">
                                                            <span class="main-text">Drag & drop image here</span>
                                                            <span class="sub-text">PNG format recommended</span>
                                                        </div>
                                                    </label>
                                                    <div id="hide-image-info" class="file-info"></div>
                                                </div>
                                            </div>
                                            
                                            <div id="ai-image-section" class="mb-4" style="display: none;">
                                                <div class="alert alert-info">
                                                    <div class="d-flex">
                                                        <div class="alert-icon me-3">
                                                            <i class="fas fa-info-circle"></i>
                                                        </div>
                                                        <div>
                                                            An AI image will be generated based on your secret message content. You can also provide a custom prompt if you prefer specific imagery.
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="form-group mb-3">
                                                    <label class="form-label">AI Provider</label>
                                                    <div class="d-flex">
                                                        <div class="form-check me-3">
                                                            <input class="form-check-input" type="radio" name="ai_provider" id="provider-huggingface" value="huggingface" checked>
                                                            <label class="form-check-label" for="provider-huggingface">
                                                                Hugging Face
                                                            </label>
                                                        </div>
                                                        <div class="form-check">
                                                            <input class="form-check-input" type="radio" name="ai_provider" id="provider-openai" value="openai">
                                                            <label class="form-check-label" for="provider-openai">
                                                                DALL-E (OpenAI)
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="form-text text-muted mt-1">
                                                        DALL-E generally produces higher quality images but requires an OpenAI API key.
                                                    </div>
                                                </div>
                                                
                                                <div class="form-group mb-3">
                                                    <label for="image-prompt" class="form-label">Custom Image Description (Optional)</label>
                                                    <div class="input-group">
                                                        <input type="text" name="prompt" id="image-prompt" class="form-control" placeholder="Provide a custom prompt or leave blank to generate one based on your message">
                                                        <button type="button" class="btn btn-outline-secondary" id="generate-preview-btn">
                                                            <i class="fas fa-eye me-1"></i>Preview
                                                        </button>
                                                    </div>
                                                    <div class="form-text text-muted">
                                                        If left blank, an image will be intelligently created based on keywords from your hidden message.
                                                    </div>
                                                </div>
                                                
                                                <!-- Hidden input for preview token -->
                                                <input type="hidden" id="preview-token" name="preview_token" value="">
                                            </div>
                                            
                                            <div id="preview-container" class="text-center mb-3" style="display: none;">
                                                <div class="card">
                                                    <div class="card-body p-2 p-md-3">
                                                        <h5 class="card-title">Image Preview</h5>
                                                        <div id="preview-loading" class="my-2 my-md-3">
                                                            <div class="spinner-border text-primary" role="status">
                                                                <span class="visually-hidden">Loading...</span>
                                                            </div>
                                                            <p class="mt-2">Generating image... This may take a few seconds.</p>
                                                        </div>
                                                        <img id="preview-image" class="img-fluid rounded mb-2" style="max-height: 300px; display: none;">
                                                        <div id="preview-error" class="alert alert-danger mt-2 mt-md-3" style="display: none;"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-eye-slash me-2"></i>Hide Message in Image
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <!-- Reveal Hidden Message -->
                                    <div class="tab-pane fade" id="reveal-message-content" role="tabpanel">
                                        <form action="{{ url_for('reveal_message') }}" method="post" enctype="multipart/form-data">
                                            <div class="file-upload-container mb-4">
                                                <input type="file" name="image" id="reveal-image-upload" class="file-input" accept="image/*" required>
                                                <label for="reveal-image-upload" class="file-drop-area">
                                                    <div class="file-icon">
                                                        <i class="fas fa-cloud-upload-alt"></i>
                                                    </div>
                                                    <div class="file-message">
                                                        <span class="main-text">Drag & drop steganography image</span>
                                                        <span class="sub-text">Upload image with hidden message</span>
                                                    </div>
                                                </label>
                                                <div id="reveal-image-info" class="file-info"></div>
                                            </div>
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-eye me-2"></i>Reveal Hidden Message
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <!-- Edit Hidden Message -->
                                    <div class="tab-pane fade" id="edit-message-content" role="tabpanel">
                                        <form action="{{ url_for('edit_message') }}" method="post" enctype="multipart/form-data" id="edit-message-form">
                                            <div class="alert alert-info mb-4">
                                                <div class="d-flex">
                                                    <div class="alert-icon me-3">
                                                        <i class="fas fa-info-circle"></i>
                                                    </div>
                                                    <div>
                                                        Upload an image with a hidden message, edit the message, and create a new image with your updated message.
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="file-upload-container mb-4">
                                                <input type="file" name="image" id="edit-image-upload" class="file-input" accept="image/*" required>
                                                <label for="edit-image-upload" class="file-drop-area">
                                                    <div class="file-icon">
                                                        <i class="fas fa-cloud-upload-alt"></i>
                                                    </div>
                                                    <div class="file-message">
                                                        <span class="main-text">Drag & drop steganography image</span>
                                                        <span class="sub-text">Upload image with hidden message to edit</span>
                                                    </div>
                                                </label>
                                                <div id="edit-image-info" class="file-info"></div>
                                            </div>
                                            
                                            <div id="message-loading" style="display:none;" class="text-center mb-3">
                                                <div class="spinner-border text-primary" role="status">
                                                    <span class="visually-hidden">Loading...</span>
                                                </div>
                                                <p class="mt-2">Extracting hidden message...</p>
                                            </div>
                                            
                                            <div id="message-error" style="display:none;" class="alert alert-warning mb-4">
                                                <div class="d-flex">
                                                    <div class="alert-icon me-3">
                                                        <i class="fas fa-exclamation-triangle"></i>
                                                    </div>
                                                    <div>
                                                        No hidden message found in this image or the message is corrupted.
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="form-group mb-4">
                                                <label for="edit-stegano-message" class="form-label">Edit Message</label>
                                                <textarea name="message" id="edit-stegano-message" class="form-control" rows="4" placeholder="The hidden message will appear here when you upload an image..." required></textarea>
                                            </div>
                                            
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg">
                                                    <i class="fas fa-save me-2"></i>Save Updated Image
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Simple Statistics Section -->
        <div class="container mt-4 mb-4">
            <div class="row justify-content-center">
                <div class="col-lg-10 col-md-12">
                    <div class="simple-stats">
                        <div class="row row-cols-3 row-cols-md-6 g-2">
                            <div class="col">
                                <div class="stat-box">
                                    <span class="stat-count" id="file-encrypt-count">0</span>
                                    <span class="stat-label">Files Encrypted</span>
                                </div>
                            </div>
                            <div class="col">
                                <div class="stat-box">
                                    <span class="stat-count" id="file-decrypt-count">0</span>
                                    <span class="stat-label">Files Decrypted</span>
                                </div>
                            </div>
                            <div class="col">
                                <div class="stat-box">
                                    <span class="stat-count" id="text-encrypt-count">0</span>
                                    <span class="stat-label">Texts Encrypted</span>
                                </div>
                            </div>
                            <div class="col">
                                <div class="stat-box">
                                    <span class="stat-count" id="text-decrypt-count">0</span>
                                    <span class="stat-label">Texts Decrypted</span>
                                </div>
                            </div>
                            <div class="col">
                                <div class="stat-box">
                                    <span class="stat-count" id="stegano-hide-count">0</span>
                                    <span class="stat-label">Messages Hidden</span>
                                </div>
                            </div>
                            <div class="col">
                                <div class="stat-box">
                                    <span class="stat-count" id="stegano-reveal-count">0</span>
                                    <span class="stat-label">Messages Revealed</span>
                                </div>
                            </div>
                            <div class="col">
                                <div class="stat-box">
                                    <span class="stat-count" id="stegano-edit-count">0</span>
                                    <span class="stat-label">Messages Edited</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
        <footer class="footer mt-auto py-4">
            <div class="container text-center">
                <p>&copy; 2025 CipherVaultX. All rights reserved. Developed by <a href="https://github.com/djontop" target="_blank">Manthan Vasant</a></p>
            </div>
        </footer>
    
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            const fileInputs = ['direct-file-upload', 'key-file-upload', 'direct-file-decrypt-upload', 'key-file-decrypt-upload', 'hide-image-upload', 'reveal-image-upload', 'edit-image-upload'];
            
            fileInputs.forEach(inputId => {
                document.getElementById(inputId).addEventListener('change', function(e) {
                    const fileInput = e.target;
                    const infoId = inputId.replace('upload', 'info');
                    const fileInfo = document.getElementById(infoId);
                    
                    if (fileInput.files.length > 0) {
                        const file = fileInput.files[0];
                        const fileSize = (file.size / 1024).toFixed(2);
                        
                        let fileHtml = `
                            <div class="selected-file">
                                <div class="selected-file-header">
                                    <i class="fas fa-file me-2"></i>
                                    <span class="file-name">${file.name}</span>
                                    <span class="file-size">(${fileSize} KB)</span>
                                </div>
                                <div class="preview-content" id="preview-${infoId}"></div>
                            </div>
                        `;
                        
                        fileInfo.innerHTML = fileHtml;
                        
                        const previewContent = document.getElementById(`preview-${infoId}`);
                        generateFilePreview(file, previewContent);
                        
                        fileInput.closest('.file-upload-container').querySelector('.file-drop-area').classList.add('has-file');
                    } else {
                        fileInfo.innerHTML = '';
                        fileInput.closest('.file-upload-container').querySelector('.file-drop-area').classList.remove('has-file');
                    }
                });
            });
            
            function generateFilePreview(file, previewElement) {
                previewElement.innerHTML = '';
                
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        previewElement.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                        previewElement.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                } 
                else {
                    let fileIcon = 'fas fa-file'; // Default icon
                    
                    const extension = file.name.split('.').pop().toLowerCase();
                    
                    if (['pdf'].includes(extension)) {
                        fileIcon = 'fas fa-file-pdf';
                    } else if (['doc', 'docx'].includes(extension)) {
                        fileIcon = 'fas fa-file-word';
                    } else if (['xls', 'xlsx'].includes(extension)) {
                        fileIcon = 'fas fa-file-excel';
                    } else if (['ppt', 'pptx'].includes(extension)) {
                        fileIcon = 'fas fa-file-powerpoint';
                    } else if (['zip', 'rar', '7z'].includes(extension)) {
                        fileIcon = 'fas fa-file-archive';
                    } else if (['txt', 'md'].includes(extension)) {
                        fileIcon = 'fas fa-file-alt';
                    } else if (['mp3', 'wav', 'ogg'].includes(extension)) {
                        fileIcon = 'fas fa-file-audio';
                    } else if (['mp4', 'avi', 'mov'].includes(extension)) {
                        fileIcon = 'fas fa-file-video';
                    } else if (['html', 'css', 'js', 'php', 'py', 'java'].includes(extension)) {
                        fileIcon = 'fas fa-file-code';
                    }
                    
                    previewElement.innerHTML = `
                        <div class="document-preview">
                            <i class="${fileIcon}"></i>
                            <span>${file.name}</span>
                        </div>
                    `;
                    previewElement.style.display = 'block';
                }
            }
            
            document.getElementById('generate-file-key').addEventListener('click', function() {
                fetch('/generate_key', { method: 'POST' })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            document.getElementById('file-encrypt-key').value = data.key;
                        }
                    });
            });
            
            document.getElementById('generate-text-key').addEventListener('click', function() {
                fetch('/generate_key', { method: 'POST' })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            document.getElementById('text-encrypt-key').value = data.key;
                        }
                    });
            });
            
            const themeToggle = document.getElementById('theme-toggle');
            const htmlElement = document.documentElement;
            
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                htmlElement.setAttribute('data-theme', savedTheme);
            } else {
                const prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (prefersDarkMode) {
                    htmlElement.setAttribute('data-theme', 'dark');
                }
            }
            updateToggleButton();
            
            themeToggle.addEventListener('click', () => {
                const currentTheme = htmlElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                htmlElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                
                updateToggleButton();
            });
            
            function updateToggleButton() {
                const currentTheme = htmlElement.getAttribute('data-theme');
                themeToggle.classList.toggle('dark-mode-active', currentTheme === 'dark');
            }
            
            const useAiToggle = document.getElementById('use-ai-toggle');
            const useAiValue = document.getElementById('use-ai-value');
            const uploadImageSection = document.getElementById('upload-image-section');
            const aiImageSection = document.getElementById('ai-image-section');
            const hideImageUpload = document.getElementById('hide-image-upload');
            const imagePrompt = document.getElementById('image-prompt');
            const generatePreviewBtn = document.getElementById('generate-preview-btn');
            const previewContainer = document.getElementById('preview-container');
            const previewLoading = document.getElementById('preview-loading');
            const previewImage = document.getElementById('preview-image');
            const previewError = document.getElementById('preview-error');
            
            useAiToggle.addEventListener('change', function() {
                const useAi = this.checked;
                useAiValue.value = useAi.toString();
                
                if (useAi) {
                    uploadImageSection.style.display = 'none';
                    aiImageSection.style.display = 'block';
                    hideImageUpload.required = false;
                    imagePrompt.required = false;
                } else {
                    uploadImageSection.style.display = 'block';
                    aiImageSection.style.display = 'none';
                    hideImageUpload.required = true;
                    imagePrompt.required = false;
                    previewContainer.style.display = 'none';
                    previewImage.style.display = 'none';
                    previewError.style.display = 'none';
                    document.getElementById('preview-token').value = '';
                }
            });
            
            generatePreviewBtn.addEventListener('click', function() {
                const prompt = imagePrompt.value.trim();
                const message = document.getElementById('stegano-message').value.trim();
                const aiProvider = document.querySelector('input[name="ai_provider"]:checked').value;
                previewContainer.style.display = 'block';
                previewLoading.style.display = 'block';
                previewImage.style.display = 'none';
                previewError.style.display = 'none';
                const formData = new FormData();
                formData.append('prompt', prompt);
                formData.append('message', message);
                formData.append('ai_provider', aiProvider);
                
                fetch('/generate_image', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        previewLoading.style.display = 'none';
                        previewImage.src = data.image;
                        previewImage.style.display = 'block';
                        document.getElementById('preview-token').value = data.preview_token;
                        if (data.prompt && prompt === '') {
                            imagePrompt.value = data.prompt;
                        }
                        const providerName = data.provider === 'openai' ? 'DALL-E' : 'Hugging Face';
                        console.log(`Image generated with ${providerName}`);
                    } else {
                        previewLoading.style.display = 'none';
                        previewError.textContent = data.error || 'Unknown error generating image';
                        previewError.style.display = 'block';
                    }
                })
                .catch(error => {
                    previewLoading.style.display = 'none';
                    previewError.textContent = 'Network error: ' + error.message;
                    previewError.style.display = 'block';
                });
            });
            document.getElementById('hide-message-form').addEventListener('submit', function(e) {
                const useAi = useAiToggle.checked;
                return true;
            });
            function fetchAndUpdateStats() {
                fetch('/stats-data', {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(stats => {
                    document.getElementById('file-encrypt-count').textContent = stats.counts['file_encryption'] || 0;
                    document.getElementById('file-decrypt-count').textContent = stats.counts['file_decryption'] || 0;
                    document.getElementById('text-encrypt-count').textContent = stats.counts['text_encryption'] || 0;
                    document.getElementById('text-decrypt-count').textContent = stats.counts['text_decryption'] || 0;
                    document.getElementById('stegano-hide-count').textContent = stats.counts['steganography_hide'] || 0;
                    document.getElementById('stegano-reveal-count').textContent = stats.counts['steganography_reveal'] || 0;
                    document.getElementById('stegano-edit-count').textContent = stats.counts['steganography_edit'] || 0;
                })
                .catch(error => {
                    console.error('Error fetching statistics:', error);
                });
            }
            document.addEventListener('DOMContentLoaded', function() {
                fetchAndUpdateStats();
            });
            document.querySelectorAll('.file-drop-area').forEach(dropArea => {
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropArea.addEventListener(eventName, preventDefaults, false);
                });
                
                function preventDefaults(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    dropArea.addEventListener(eventName, highlight, false);
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    dropArea.addEventListener(eventName, unhighlight, false);
                });
                
                function highlight() {
                    dropArea.classList.add('highlight');
                }
                
                function unhighlight() {
                    dropArea.classList.remove('highlight');
                }
                
                dropArea.addEventListener('drop', handleDrop, false);
                
                function handleDrop(e) {
                    const dt = e.dataTransfer;
                    const files = dt.files;
                    const fileInput = dropArea.parentElement.querySelector('.file-input');
                    fileInput.files = files;
                    const event = new Event('change');
                    fileInput.dispatchEvent(event);
                }
            });
            document.getElementById('edit-image-upload').addEventListener('change', function(e) {
                if (this.files.length > 0) {
                    // Show loading indicator
                    document.getElementById('message-loading').style.display = 'block';
                    document.getElementById('message-error').style.display = 'none';
                    document.getElementById('edit-stegano-message').value = '';
                    const formData = new FormData();
                    formData.append('image', this.files[0]);
                    fetch('/extract_message', {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('message-loading').style.display = 'none';
                        
                        if (data.success) {
                            document.getElementById('edit-stegano-message').value = data.message;
                        } else {
                            document.getElementById('message-error').style.display = 'block';
                        }
                    })
                    .catch(error => {
                        document.getElementById('message-loading').style.display = 'none';
                        document.getElementById('message-error').style.display = 'block';
                        console.error('Error:', error);
                    });
                }
            });
            document.getElementById('edit-message-tab').addEventListener('click', function() {
                document.getElementById('edit-image-upload').value = '';
                document.getElementById('edit-image-info').innerHTML = '';
                document.getElementById('edit-stegano-message').value = '';
                document.getElementById('message-loading').style.display = 'none';
                document.getElementById('message-error').style.display = 'none';
            });
        </script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const loader = document.getElementById('loader');
                const loaderBar = document.getElementById('loader-bar');
                const loaderMessage = document.getElementById('loader-message');
                const loaderLogo = document.getElementById('loader-logo');
                const loaderComplete = document.getElementById('loader-complete');
                const body = document.body;
                loaderLogo.addEventListener('error', function() {
                    this.src = 'https://r2.fivemanage.com/3nWOCwH1JwmDjPjMMZ9V3/cipherofficiallogo.png';
                });
                const securityMessages = [
                    "Initializing secure environment...",
                    "Establishing secure connection...",
                    "Verifying cryptographic integrity...",
                    "Initializing steganography modules...",
                    "Checking environment security...",
                    "Loading encryption algorithms...",
                    "Preparing secure vault...",
                    "Configuring key management...",
                    "Activating security features...",
                    "Setting up encryption protocols...",
                    "Validating security certificates...",
                    "Initializing cipher algorithms...",
                    "Preparing steganography engine...",
                    "Establishing secure channels...",
                    "Loading cryptographic libraries...",
                    "Verifying secure environment...",
                    "Configuring cipher modes...",
                    "Initializing secure storage...",
                    "Setting up key exchange protocols...",
                    "Securing communication channels..."
                ];
                let messageIndex = 0;
                const messageInterval = setInterval(() => {
                    loaderMessage.textContent = securityMessages[messageIndex];
                    messageIndex = (messageIndex + 1) % securityMessages.length;
                }, 750);
                setTimeout(() => {
                    loaderBar.style.width = '20%';
                    loaderBar.style.transition = 'width 2s ease-out';
                    
                    setTimeout(() => {
                        loaderBar.style.width = '50%';
                        loaderBar.style.transition = 'width 3s ease-in-out';
                        
                        setTimeout(() => {s
                            loaderBar.style.width = '75%';
                            loaderBar.style.transition = 'width 3s ease-in-out';
                            
                            setTimeout(() => {
                                loaderBar.style.width = '100%';
                                loaderBar.style.transition = 'width 2s ease-in';
                                setTimeout(() => {
                                    loaderComplete.style.display = 'block';
                                    setTimeout(() => {
                                        loaderComplete.classList.add('show');
                                    }, 50);
                                }, 1800);
                            }, 3000);
                        }, 3000);
                    }, 2000);
                }, 100);
                function hasVisitedBefore() {
                    return sessionStorage.getItem('hasVisitedCipherVaultX') === 'true';
                }
                
                function markAsVisited() {
                    sessionStorage.setItem('hasVisitedCipherVaultX', 'true');
                }
                
                if (hasVisitedBefore()) {
                    hideLoader(0);
                } else {
                    hideLoader(10000);
                    markAsVisited();
                }
                
                function hideLoader(delay) {
                    setTimeout(() => {
                        clearInterval(messageInterval);
                        loaderComplete.classList.remove('show');
                        loader.classList.add('fade-out');
                        setTimeout(() => {
                            loader.style.display = 'none';
                            body.classList.remove('loading');
                        }, 500);
                    }, delay);
                }
            });
        </script>
    </body>
</html>